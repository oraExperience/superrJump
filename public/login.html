<!DOCTYPE html>
<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Superjump - Login</title>
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;500;700;800&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#f4c025",
                        "background-light": "#f8f8f5",
                        "background-dark": "#221e10",
                    },
                    fontFamily: {
                        "display": ["Lexend", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "1rem",
                        "lg": "2rem",
                        "xl": "3rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
<style>
        body {
            font-family: 'Lexend', sans-serif;
        }
    </style>
</head>
<body class="font-display">
<div class="relative flex min-h-screen w-full flex-col items-center justify-center bg-background-light dark:bg-background-dark p-4 md:p-6">
<div class="absolute inset-0 z-0 h-full w-full bg-cover bg-center bg-no-repeat" style="background-image: url('visualisation2.png');">
</div>
<div class="relative z-10 flex w-full max-w-md flex-col items-center">
<div class="w-full rounded-lg bg-white dark:bg-background-dark p-8 shadow-2xl md:p-10">
<div class="mb-6 flex flex-col items-center">
<div class="flex items-center">
<img src="/logo.png" alt="SuperrJump Logo" class="h-16 w-16" />
<h2 class="text-4xl font-extrabold leading-tight tracking-tighter text-[#1c180d] dark:text-white md:text-5xl lg:text-4xl">SuperrJump</h2>
</div>
<!-- <p class="mt-3 text-xl text-[#1c180d] dark:text-white/90">Your AI partner</p> -->
</div>
<h1 class="text-2xl font-extrabold text-[#1c180d] dark:text-white">Sign In</h1>
<!-- <p class="mt-2 text-base text-slate-500 dark:text-white/70">Welcome back! Please enter your details.</p> -->
<form class="mt-8 flex flex-col gap-6">
<label class="flex flex-col">
<p class="pb-2 text-sm font-medium leading-normal text-[#1c180d] dark:text-white/90">Email Address</p>
<input class="form-input h-12 w-full rounded-md border border-slate-300 dark:border-primary/20 bg-white dark:bg-background-dark/50 px-4 text-base font-normal text-[#1c180d] dark:text-white placeholder:text-slate-400 dark:placeholder:text-white/40 focus:border-primary focus:outline-0 focus:ring-2 focus:ring-primary/50" placeholder="" type="email" value=""/>
</label>
<label class="flex flex-col">
<p class="pb-2 text-sm font-medium leading-normal text-[#1c180d] dark:text-white/90">Password</p>
<div class="relative flex w-full flex-1 items-stretch">
<input id="passwordField" class="form-input h-12 w-full rounded-md border border-slate-300 dark:border-primary/20 bg-white dark:bg-background-dark/50 px-4 pr-12 text-base font-normal text-[#1c180d] dark:text-white placeholder:text-slate-400 dark:placeholder:text-white/40 focus:border-primary focus:outline-0 focus:ring-2 focus:ring-primary/50" placeholder="" type="password" value=""/>
<button type="button" onclick="togglePassword()" class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 focus:outline-none">
<span id="eyeIcon" class="material-symbols-outlined !text-2xl">visibility</span>
</button>
</div>
</label>
<div class="mt-4">
<button class="flex h-12 w-full items-center justify-center rounded-md bg-primary px-6 text-base font-bold text-background-dark shadow-sm transition-transform hover:scale-[1.02] active:scale-[0.98]" type="submit">Sign In</button>
</div>
<div class="flex items-center justify-between">
<a class="text-sm font-medium text-blue-600 hover:underline dark:text-blue-400" href="#">Forgot Password?</a>
<a class="text-sm font-medium text-blue-600 hover:underline dark:text-blue-400" href="/">Home</a>
</div>

<script>
// Toggle password visibility
function togglePassword() {
    const passwordField = document.getElementById('passwordField');
    const eyeIcon = document.getElementById('eyeIcon');
    
    if (passwordField.type === 'password') {
        passwordField.type = 'text';
        eyeIcon.textContent = 'visibility_off';
    } else {
        passwordField.type = 'password';
        eyeIcon.textContent = 'visibility';
    }
}
</script>


</form>
</div>
</div>

<script>
// Prevent forward navigation to authenticated pages without login
window.addEventListener('load', () => {
    // Clear session data when on login page
    sessionStorage.removeItem('token');
    sessionStorage.removeItem('user');
    
    // Disable browser back/forward cache to prevent cached authenticated pages
    window.history.pushState(null, null, window.location.href);
    window.addEventListener('popstate', () => {
        window.history.pushState(null, null, window.location.href);
    });
});

// Login form handling
const loginForm = document.querySelector('form');
const emailInput = document.querySelector('input[type="email"]');
const passwordInput = document.getElementById('passwordField');

// Add IDs and required attributes
loginForm.id = 'loginForm';
emailInput.id = 'email';
emailInput.name = 'email';
emailInput.required = true;
emailInput.placeholder = 'Enter your email';
passwordInput.name = 'password';
passwordInput.required = true;
passwordInput.placeholder = 'Enter your password';

// Add error message div
const errorDiv = document.createElement('div');
errorDiv.id = 'errorMessage';
errorDiv.className = 'hidden p-3 bg-red-100 border border-red-400 text-red-700 rounded-md text-sm mb-4';
loginForm.insertBefore(errorDiv, loginForm.firstChild);

loginForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const email = emailInput.value.trim();
    const password = passwordInput.value;
    
    // Clear previous error
    errorDiv.classList.add('hidden');
    
    // Disable button
    const submitBtn = loginForm.querySelector('button[type="submit"]');
    const originalText = submitBtn.textContent;
    submitBtn.disabled = true;
    submitBtn.textContent = 'Signing in...';
    
    try {
        const response = await fetch('/api/users/login', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ email, password })
        });
        
        const data = await response.json();
        
        if (data.success) {
            // Store JWT token and user data in sessionStorage
            sessionStorage.setItem('token', data.token);
            sessionStorage.setItem('user', JSON.stringify(data.user));
            sessionStorage.setItem('fromLogin', 'true');
            
            // Replace current history entry to prevent back navigation to login
            window.location.replace('/assessments.html');
        } else {
            // Show error message
            errorDiv.textContent = data.message || 'Login failed. Please try again.';
            errorDiv.classList.remove('hidden');
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
        }
    } catch (error) {
        console.error('Login error:', error);
        errorDiv.textContent = 'An error occurred. Please try again.';
        errorDiv.classList.remove('hidden');
        submitBtn.disabled = false;
        submitBtn.textContent = originalText;
    }
});
</script>


</div>

</body></html>